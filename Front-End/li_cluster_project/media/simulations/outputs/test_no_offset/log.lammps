LAMMPS (22 Jul 2025)
# Enhanced LAMMPS TMD simulation
units metal
atom_style atomic
boundary f f f

# Read initial structure
read_data input.data
Reading data file ...
  orthogonal box = (-8.4276 -9.2826 -4.5725) to (5 4.1431 7.1413)
  1 by 1 by 1 MPI processor grid
  reading atoms ...
  4 atoms
  read_data CPU = 0.001 seconds

# Li-Li interactions using Lennard-Jones potential
pair_style lj/cut 10.0
pair_coeff 1 1 0.05 2.5

# Define atom groups
group mobile id > 0
4 atoms in group mobile

# Energy minimization
minimize 1.0e-4 1.0e-6 1000 10000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 12
  ghost atom cutoff = 12
  binsize = 6, bins = 3 3 2
  1 neighbor lists, perpetual/occasional/extra = 1 0 0
  (1) pair lj/cut, perpetual
      attributes: half, newton on
      pair build: half/bin/atomonly/newton
      stencil: half/bin/3d
      bin: standard
Per MPI rank memory allocation (min/avg/max) = 4.16 | 4.16 | 4.16 Mbytes
   Step          Temp          E_pair         E_mol          TotEng         Press     
         0   0             -0.19267912     0             -0.19267912    -162.33727    
        65   0             -0.29999491     0             -0.29999491    -0.014678157  
Loop time of 2.1667e-05 on 1 procs for 65 steps with 4 atoms

101.5% CPU use with 1 MPI tasks x no OpenMP threads

Minimization stats:
  Stopping criterion = energy tolerance
  Energy initial, next-to-last, final = 
    -0.192679116838022  -0.29998316612659    -0.299994905476
  Force two-norm initial, final = 0.15791248 0.0021476288
  Force max component initial, final = 0.071467507 0.0010668444
  Final line search alpha, max atom move = 1 0.0010668444
  Iterations, force evaluations = 65 65

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 9.664e-06  | 9.664e-06  | 9.664e-06  |   0.0 | 44.60
Neigh   | 5e-07      | 5e-07      | 5e-07      |   0.0 |  2.31
Comm    | 2.879e-06  | 2.879e-06  | 2.879e-06  |   0.0 | 13.29
Output  | 0          | 0          | 0          |   0.0 |  0.00
Modify  | 0          | 0          | 0          |   0.0 |  0.00
Other   |            | 8.624e-06  |            |       | 39.80

Nlocal:              4 ave           4 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              6 ave           6 max           6 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6
Ave neighs/atom = 1.5
Neighbor list builds = 1
Dangerous builds = 0

# Initialize velocities
velocity mobile create 300.0 4928459 rot yes dist gaussian

# TMD setup using spring forces towards target positions
# Apply spring forces to guide atoms towards target structure
fix tmd_fix mobile spring/self 10.0

# Temperature control
fix nvt_fix mobile nvt temp 300.0 300.0 100.0

# Output trajectory every 20 steps for smooth animation
dump traj_dump all xyz 20 trajectory.xyz
dump_modify traj_dump element Li

# Thermodynamics output
thermo_style custom step temp press etotal pe ke f_tmd_fix
thermo 100

# Run TMD simulation
run 4000
Generated 0 of 0 mixed pair_coeff terms from geometric mixing rule
Per MPI rank memory allocation (min/avg/max) = 3.535 | 3.535 | 3.535 Mbytes
   Step          Temp          Press          TotEng         PotEng         KinEng       f_tmd_fix   
        65   300            58.828092     -0.18366077    -0.29999491     0.11633413     0            
       100   60.221793      1.1887892     -0.27231128    -0.29566412     0.023352833    0.088991448  
       200   189.26988      17.529461     -0.22423457    -0.29762973     0.073395157    0.040733487  
       300   276.70047      30.049169     -0.19187458    -0.29917361     0.10729903     0.0082492817 
       400   247.81307      29.91573      -0.20289083    -0.29898789     0.096097059    0.019304758  
       500   135.06612      22.234208     -0.24480409    -0.29718009     0.052375999    0.061377694  
       600   49.107541      19.887052     -0.27652111    -0.29556406     0.019042944    0.093217499  
       700   72.699712      31.02728      -0.26773004    -0.29592157     0.028191526    0.084391861  
       800   181.99746      52.413841     -0.2272913     -0.29786635     0.070575055    0.043796891  
       900   271.67903      71.835219     -0.19390035    -0.29925216     0.10535181     0.010280972  
      1000   253.70394      77.398044     -0.2001559     -0.29853732     0.098381424    0.016565806  
      1100   137.56579      67.946309     -0.24286842    -0.29621374     0.053345323    0.059444651  
      1200   23.27612       55.020309     -0.28514069    -0.29416672     0.0090260238   0.10187867   
      1300   11.829847      52.027449     -0.28941124    -0.29399862     0.0045873832   0.1061661    
      1400   112.58942      60.427177     -0.25215434    -0.29581431     0.043659973    0.068768251  
      1500   235.14436      68.421445     -0.20698696    -0.29817134     0.091184383    0.02342742   
      1600   272.47768      63.465073     -0.19351341    -0.29917492     0.10566151     0.0098987835 
      1700   196.59472      44.422441     -0.22184835    -0.29808393     0.076235584    0.038340044  
      1800   82.748816      22.036407     -0.26404133    -0.2961297      0.032088372    0.080696586  
      1900   41.614055      9.4044296     -0.27932803    -0.29546515     0.016137116    0.096044176  
      2000   115.37682      11.660232     -0.25211446    -0.29685534     0.044740872    0.068726465  
      2100   234.67611      22.029598     -0.20780283    -0.29880563     0.091002804    0.024246949  
      2200   284.72425      27.263286     -0.18896498    -0.29937548     0.11041049     0.0053413837 
      2300   215.39143      20.017879     -0.21458818    -0.29811276     0.083524584    0.031064996  
      2400   85.955903      6.7141927     -0.26277271    -0.29610473     0.033332018    0.079432818  
      2500   9.012613       1.812421      -0.29140225    -0.29489717     0.003494915    0.10817124   
      2600   50.401121      13.917894     -0.27583609    -0.29538066     0.019544569    0.092548331  
      2700   171.17543      37.087471     -0.23078883    -0.29716731     0.066378481    0.047332707  
      2800   261.24157      55.990425     -0.1974439     -0.29874827     0.10130437     0.013861246  
      2900   239.40469      60.474463     -0.20572228    -0.29855873     0.092836455    0.022170708  
      3000   129.95315      54.349059     -0.24615362    -0.2965469      0.050393288    0.06275966   
      3100   39.94968       49.695368     -0.27918843    -0.29468013     0.015491704    0.09592595   
      3200   57.69824       55.018192     -0.27267965    -0.2950539      0.022374248    0.089392875  
      3300   170.37016      68.655017     -0.23135997    -0.29742619     0.066066214    0.047912322  
      3400   276.23541      79.940857     -0.19233941    -0.2994581      0.10711869     0.0087430762 
      3500   277.78919      77.222668     -0.19160103    -0.29932224     0.10772121     0.008005902  
      3600   171.43018      58.882454     -0.23089023    -0.2973675      0.066477268    0.047448022  
      3700   51.304904      36.723054     -0.27549535    -0.29539038     0.019895038    0.092224658  
      3800   22.279428      25.427995     -0.28627896    -0.29491849     0.0086395263   0.10305258   
      3900   104.74932      28.35108      -0.25552011    -0.29613985     0.040619738    0.072181907  
      4000   219.08073      35.106657     -0.2129649     -0.29792012     0.084955219    0.029468295  
      4065   77.849399      14.558775     -0.2662966     -0.29648507     0.030188474    0.08299623   
Loop time of 0.00210671 on 1 procs for 4000 steps with 4 atoms

Performance: 164047.414 ns/day, 0.000 hours/ns, 1898696.924 timesteps/s, 7.595 Matom-step/s
85.4% CPU use with 1 MPI tasks x no OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 0.00031673 | 0.00031673 | 0.00031673 |   0.0 | 15.03
Neigh   | 0          | 0          | 0          |   0.0 |  0.00
Comm    | 0.00015355 | 0.00015355 | 0.00015355 |   0.0 |  7.29
Output  | 0.00062999 | 0.00062999 | 0.00062999 |   0.0 | 29.90
Modify  | 0.00075545 | 0.00075545 | 0.00075545 |   0.0 | 35.86
Other   |            | 0.000251   |            |       | 11.91

Nlocal:              4 ave           4 max           4 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Nghost:              0 ave           0 max           0 min
Histogram: 1 0 0 0 0 0 0 0 0 0
Neighs:              6 ave           6 max           6 min
Histogram: 1 0 0 0 0 0 0 0 0 0

Total # of neighbors = 6
Ave neighs/atom = 1.5
Neighbor list builds = 0
Dangerous builds = 0

# Cleanup
unfix tmd_fix
unfix nvt_fix
undump traj_dump
Total wall time: 0:00:00
